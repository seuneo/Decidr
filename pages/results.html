<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Results - Decidr</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link rel="stylesheet" href="../styles.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#E07A5F',
                        'secondary': '#3D405B',
                        'background': '#F4F1DE',
                        'success': '#10B981',
                        'danger': '#EF4444'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-background">
    <div class="flex flex-col bg-background">
        <!-- Header -->
        <div class="sticky top-0 z-10 flex items-center justify-between p-4 bg-background">
            <div class="flex items-center">
                <button class="bg-transparent border-none text-inherit cursor-pointer p-2 rounded-lg transition-colors duration-200 hover:bg-[#E8E0C7]" onclick="goHome()">
                    <i data-lucide="home" class="h-4 w-4"></i>
                </button>
                <h1 class="ml-2 font-semibold">Results</h1>
            </div>
            <div class="flex items-center space-x-2 text-sm text-gray-500">
                <i data-lucide="users" class="h-4 w-4"></i>
                <span id="results-participants">25 joined</span>
            </div>
        </div>

        <!-- Content -->
        <div class="flex items-center justify-center p-4" style="height: calc(100vh - 80px);">
            <div class="max-w-xs sm:max-w-sm md:max-w-md lg:max-w-lg w-full space-y-4">
                <!-- Question -->
                <div class="text-center">
                    <h2 class="text-2xl md:text-3xl font-bold text-black leading-relaxed" id="results-question"></h2>
                </div>

                <!-- Winner Display -->
                <div class="text-center mb-4">
                    <div id="winner-icon" class="w-16 h-16 rounded-3xl flex items-center justify-center mx-auto shadow-lg transition-all duration-1200 ease-out scale-in">
                        <!-- Winner icon will be inserted here -->
                    </div>
                    <div id="winner-text">
                        <!-- Winner text will be inserted here -->
                    </div>
                </div>

                <!-- Results Card -->
                <div class="bg-white border-2 border-secondary rounded-lg p-6">
                    <div class="flex items-center justify-center gap-3 mb-4">
                        <i data-lucide="bar-chart-3" class="h-5 w-5 text-slate-600"></i>
                        <h4 class="font-semibold text-black">Results</h4>
                    </div>
                    
                    <div id="results-content">
                        <!-- Results will be inserted here -->
                    </div>
                </div>

                <div class="text-center space-y-4">
                    <div class="text-sm text-slate-500">
                        Thanks for using <span class="font-semibold text-primary">Decidr</span>! üó≥Ô∏è
                    </div>
                    <div class="flex items-center justify-center space-x-2">
                        <button class="border-2 rounded-full transition-all duration-300 hover:scale-110 cursor-pointer w-10 h-10 flex items-center justify-center bg-primary border-secondary text-white shadow-[0_2px_0_#3D405B]" onclick="shareResults()" title="Share Results">
                            <i data-lucide="share-2" class="h-4 w-4"></i>
                        </button>
                        <button class="border-2 rounded-full transition-all duration-300 hover:scale-110 cursor-pointer w-10 h-10 flex items-center justify-center bg-primary border-secondary text-white shadow-[0_2px_0_#3D405B]" onclick="goHome()" title="Go to Home">
                            <i data-lucide="home" class="h-4 w-4"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="../scripts.js"></script>
    <script>
        function shareResults() {
            app.shareResults();
        }

        function displayResults() {
            if (!app.room) {
                showToast('No room data found', 'error');
                goHome();
                return;
            }

            const results = app.getResults();
            if (!results) {
                showToast('No results available', 'error');
                goHome();
                return;
            }

            // Update UI
            document.getElementById('results-question').textContent = app.room.question;
            document.getElementById('results-participants').textContent = `${app.room.participants} joined`;

            // Show winner
            const winnerIcon = document.getElementById('winner-icon');
            const winnerText = document.getElementById('winner-text');
            
            if (results.winner !== 'TIE') {
                winnerIcon.className = `status-icon ${results.winner === 'YES' ? 'success' : 'danger'} animate-scale-in`;
                winnerIcon.innerHTML = `
                    <i data-lucide="${results.winner === 'YES' ? 'thumbs-up' : 'thumbs-down'}" class="h-8 w-8 text-white"></i>
                `;
                winnerText.innerHTML = `
                    <p class="winner-text mt-4">The majority has decided</p>
                `;
            } else {
                winnerIcon.className = 'status-icon primary animate-scale-in';
                winnerIcon.innerHTML = `
                    <i data-lucide="bar-chart-3" class="h-8 w-8 text-white"></i>
                `;
                winnerText.innerHTML = `
                    <h3 class="winner-title">TIE</h3>
                    <p class="winner-text">Equal votes on both sides</p>
                `;
            }

            // Show results
            const resultsContent = document.getElementById('results-content');
            if (results.totalVotes > 0) {
                resultsContent.innerHTML = `
                    <div class="results-content">
                        <div class="results-item">
                            <div class="flex justify-between items-center">
                                <div class="vote-label" style="color: #059669;">
                                    <i data-lucide="thumbs-up" class="h-4 w-4"></i>
                                    <span>YES (${results.upVotes} votes)</span>
                                </div>
                                <span class="vote-count">${results.yesPercentage}%</span>
                            </div>
                            <div class="results-progress">
                                <div class="results-progress-fill progress-yes" style="width: ${results.yesPercentage}%"></div>
                            </div>
                        </div>
                        <div class="results-item">
                            <div class="flex justify-between items-center">
                                <div class="vote-label" style="color: #dc2626;">
                                    <i data-lucide="thumbs-down" class="h-4 w-4"></i>
                                    <span>NO (${results.downVotes} votes)</span>
                                </div>
                                <span class="vote-count">${results.noPercentage}%</span>
                            </div>
                            <div class="results-progress">
                                <div class="results-progress-fill progress-no" style="width: ${results.noPercentage}%"></div>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                resultsContent.innerHTML = `
                    <div class="text-center py-8">
                        <div class="status-icon primary mb-4">
                            <i data-lucide="bar-chart-3" class="h-8 w-8 text-white"></i>
                        </div>
                        <h4 class="text-lg font-semibold text-black mb-2">No Votes Yet</h4>
                        <p class="text-sm text-slate-600">
                            Results will appear here once participants start voting
                        </p>
                    </div>
                `;
            }
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            if (!app.room) {
                showToast('No room data found', 'error');
                goHome();
                return;
            }

            // Display results with animation
            setTimeout(() => {
                displayResults();
            }, 100);
        });
    </script>
</body>
</html>